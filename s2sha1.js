function s2SHA1()
{
	pc = ['', '', '', '', '', '', ''];
	for (i=0; i<80; i++){ if(i<20){ if(i<16){ pc[0]+='obj.W['+i+'] = obj.wb[i+'+i+'];'; if(i<8)pc[6]+='obj+='+((v=7-i)==0?'(i&0x0f)':'((i>>>('+(v)+'*4))&0x0f)')+'.toString(16);'; }; pc[2]+='this.sft( (this.rol(obj.L[0], 5) + ((obj.L[1] & obj.L[2]) | (~obj.L[1] & obj.L[3])) + obj.L[4] + obj.W['+i+'] + 0x5A827999) & 0x0ffffffff, obj);';  }; if(i>15){ pc[1]+='obj.W['+i+'] = this.rol(obj.W['+(i-3)+'] ^ obj.W['+(i-8)+'] ^ obj.W['+(i-14)+'] ^ obj.W['+(i-16)+'], 1);'; if(i>19&&i<40)pc[3]+='this.sft( (this.rol(obj.L[0], 5) + (obj.L[1] ^ obj.L[2] ^ obj.L[3]) + obj.L[4] + obj.W['+i+'] + 0x6ED9EBA1) & 0x0ffffffff, obj);'; if(i>39&&i<60)pc[4]+='this.sft( (this.rol(obj.L[0], 5) + ((obj.L[1] & obj.L[2]) | (obj.L[1] & obj.L[3]) | (obj.L[2] & obj.L[3])) + obj.L[4] + obj.W['+i+'] + 0x8F1BBCDC) & 0x0ffffffff, obj);'; if(i>59)pc[5]+='this.sft( ( this.rol(obj.L[0], 5) + (obj.L[1] ^ obj.L[2] ^ obj.L[3]) + obj.L[4] + obj.W['+i+'] + 0xCA62C1D6) & 0x0ffffffff, obj);'; }; }; 
	for(var i = 0; i<7; i++)this['s'+i] = new Function('obj', 'i', pc[i] + ' return obj');
	this.rol = function(n, s){ return (n << s) | (n >>> (32 - s)); };
	this.sft = function(v, obj){ obj.L[4] = obj.L[3]; obj.L[3] = obj.L[2]; obj.L[2] = this.rol(obj.L[1], 30); obj.L[1] = obj.L[0]; obj.L[0] = v; return obj; }; 
	this.fin = function(obj){  if(arguments.length>1){ obj.H[0] = (obj.H[0] + obj.L[0]) & 0x0ffffffff; obj.H[1] = (obj.H[1] + obj.L[1]) & 0x0ffffffff; obj.H[2] = (obj.H[2] + obj.L[2]) & 0x0ffffffff; obj.H[3] = (obj.H[3] + obj.L[3]) & 0x0ffffffff; obj.H[4] = (obj.H[4] + obj.L[4]) & 0x0ffffffff; } else { obj.L[0] = obj.H[0]; obj.L[1] = obj.H[1]; obj.L[2] = obj.H[2]; obj.L[3] = obj.H[3]; obj.L[4] = obj.H[4]; }; return obj; };
	this.iwa = function(src){ var result = []; if('string'==typeof src)src = src.split('').map(c=>c.charCodeAt(0)); for (var i=0;i<src.length-3;i+=4)result.push(src[i]<<24|src[i+1]<<16|src[i+2]<<8|src[i+3]); switch(src.length%4){ case 0: i = 0x080000000; break;  case 1: i = src[src.length-1]<<24 | 0x0800000; break; case 2: i = src[src.length-2]<<24 | src[src.length-1]<<16 | 0x08000; break; case 3: i = src[src.length-3]<<24 | src[src.length-2]<<16 | src[src.length-1]<<8 | 0x80; break; }; result.push(i); while((result.length%16)!=14)result.push(0); result.push(src.length>>>29); result.push((src.length<<3)&0x0ffffffff); return result; };
	this.sha1 = function(src){ var obj = {W:new Array(80), wb:this.iwa(src), H:[0x67452301,0xEFCDAB89,0x98BADCFE,0x10325476,0xC3D2E1F0], L:[0,0,0,0,0]}; for (i = 0; i<obj.wb.length; i+=16)this.fin(this.s5(this.s4(this.s3(this.s2(this.fin(this.s1(this.s0(obj, i))))))), 1); return this.s6('', obj.H[0])+this.s6('', obj.H[1])+this.s6('', obj.H[2])+this.s6('', obj.H[3])+this.s6('', obj.H[4]); };
};
